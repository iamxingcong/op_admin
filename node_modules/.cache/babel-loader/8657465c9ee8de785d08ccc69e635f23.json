{"ast":null,"code":"var _jsxFileName = \"/Users/xc/Public/capacity_1103/front_new/src/views/pages/StreamingMedia.js\";\nimport React from 'react';\nimport { Table, Button, Form, InputNumber, notification } from 'antd';\nimport { MinusCircleOutlined, PlusCircleOutlined } from '@ant-design/icons';\nimport axios from \"axios\";\nimport { APIURL } from '../../common/constdt.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class StreamingMedia extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onFinishFailed = errorInfo => {\n      console.log('Failed:', errorInfo);\n    };\n\n    this.onFinish = values => {\n      console.log('Success:', values);\n      this.staticcreate(values);\n    };\n\n    this.footer = () => {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tbfootertds\",\n        children: this.state.opendiv || this.state.tabledtnew.length === 0 ? /*#__PURE__*/_jsxDEV(Form, {\n          onFinish: this.onFinish,\n          onFinishFailed: this.onFinishFailed,\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                    label: \"\",\n                    name: \"bit_rate\",\n                    children: /*#__PURE__*/_jsxDEV(InputNumber, {\n                      placeholder: \"\\u7801\\u7387\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 264,\n                      columnNumber: 37\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 259,\n                    columnNumber: 33\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 255,\n                  columnNumber: 29\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                    label: \"\",\n                    name: \"pre_online_num\",\n                    children: /*#__PURE__*/_jsxDEV(InputNumber, {\n                      placeholder: \"\\u9884\\u4F30\\u540C\\u65F6\\u5728\\u7EBF(\\u4E07)\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 277,\n                      columnNumber: 37\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 272,\n                    columnNumber: 33\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 268,\n                  columnNumber: 29\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \" -- \"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 281,\n                    columnNumber: 33\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 29\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \" -- \"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 282,\n                    columnNumber: 33\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 282,\n                  columnNumber: 29\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                    children: /*#__PURE__*/_jsxDEV(Button, {\n                      type: \"primary\",\n                      htmlType: \"submit\",\n                      children: \" \\u786E\\u8BA4\\u6DFB\\u52A0\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 288,\n                      columnNumber: 37\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 287,\n                    columnNumber: 33\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 283,\n                  columnNumber: 29\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 25\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 22\n        }, this) : \"\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 17\n      }, this);\n    };\n\n    this.state = {\n      opendiv: false,\n      tabledtnew: [],\n      user_name: null\n    };\n    this.adddiv = this.adddiv.bind(this);\n    this.dele = this.dele.bind(this);\n    this.confirmdt = this.confirmdt.bind(this);\n  }\n\n  componentDidMount() {\n    this.agetRates();\n  }\n\n  async agetRates() {\n    const ts = this.props.event_id;\n    const url = `${APIURL}/media/list?event_id=${ts}`;\n    var that = this;\n    await axios.get(url, {\n      withCredentials: true\n    }).then(function (response) {\n      if (response.data.data) {\n        that.setState({\n          tabledtnew: response.data.data\n        });\n      }\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  async staticcreate(v) {\n    let url = `${APIURL}/media/create`;\n    var bodyFormData = new FormData();\n\n    if (!v.bit_rate || !v.pre_online_num) {\n      notification.error({\n        message: '提示',\n        description: '请输入！！',\n        duration: 60,\n        placement: 'topCenter',\n        onClick: () => {\n          console.log('Notification Clicked!');\n        }\n      });\n      return false;\n    }\n\n    bodyFormData.append(\"bit_rate\", v.bit_rate);\n    bodyFormData.append(\"event_id\", this.props.event_id);\n    bodyFormData.append(\"pre_online_num\", parseInt(v.pre_online_num));\n    var that = this;\n    await axios.post(url, bodyFormData, {\n      withCredentials: true\n    }).then(function (response) {\n      if (response.data.code === 0) {\n        notification.success({\n          message: '提示',\n          description: response.data.msg,\n          placement: 'topCenter',\n          onClick: () => {\n            console.log('Notification Clicked!');\n          }\n        });\n        that.setState({\n          opendiv: false\n        });\n        that.agetRates();\n      } else {\n        notification.error({\n          message: '提示',\n          description: response.data.msg,\n          duration: 60,\n          placement: 'topCenter',\n          onClick: () => {\n            console.log('Notification Clicked!');\n          }\n        });\n      }\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  adddiv(v) {\n    this.setState({\n      opendiv: true\n    });\n  }\n\n  async dele(v) {\n    var bodyFormData = new FormData();\n    bodyFormData.append(\"media_id\", v.id);\n    const url = `${APIURL}/media/delete`;\n    let that = this;\n    await axios.post(url, bodyFormData, {\n      withCredentials: true\n    }).then(function (response) {\n      if (response.data.code === 0) {\n        that.agetRates();\n        notification.success({\n          message: '提示',\n          description: '删除成功！',\n          placement: 'topCenter',\n          onClick: () => {\n            console.log('Notification Clicked!');\n          }\n        });\n      }\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  async confirmdt(v) {\n    const url = `${APIURL}/media/verify`;\n    var bodyFormData = new FormData();\n    bodyFormData.append(\"media_id\", v.id);\n    bodyFormData.append(\"event_id\", this.props.event_id);\n\n    if (this.props.EngName) {\n      bodyFormData.append(\"user_name\", this.props.EngName);\n    }\n\n    let that = this;\n    await axios.post(url, bodyFormData, {\n      withCredentials: true\n    }).then(function (response) {\n      if (response.data.code === 0) {\n        that.agetRates();\n        notification.success({\n          message: '提示',\n          description: '确认成功',\n          placement: 'topCenter',\n          onClick: () => {\n            console.log('Notification Clicked!');\n          }\n        });\n      } else {\n        notification.error({\n          message: '提示',\n          description: response.data.msg,\n          duration: 60,\n          placement: 'topCenter',\n          onClick: () => {\n            console.log('Notification Clicked!');\n          }\n        });\n      }\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  render() {\n    const columns = [{\n      title: '码率（Mbps）',\n      dataIndex: 'bit_rate',\n      align: \"center\",\n      width: \"20%\"\n    }, {\n      title: '预估同时在线(万)',\n      dataIndex: 'pre_online_num',\n      align: \"center\",\n      width: \"20%\"\n    }, {\n      title: '所需宽带',\n      dataIndex: 'bandwidth',\n      align: \"center\",\n      width: \"20%\",\n      render: (text, data, index) => /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\" \", data.bandwidth >= 100 ? data.bandwidth * 0.01 + \"T\" : data.bandwidth * 10 + \"G\", \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 21\n      }, this)\n    }, {\n      title: '平台负责人确认',\n      dataIndex: 'confirm_status',\n      align: \"center\",\n      width: \"20%\",\n      render: (text, data, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: data.confirm_status === 0 ? /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => this.confirmdt(data),\n          type: \"primary\",\n          size: \"small\",\n          children: \"\\u786E\\u8BA4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 29\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"brespans\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: data.confirm_user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 359,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: data.confirm_datetime\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 29\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 21\n      }, this)\n    }, {\n      title: '操作',\n      dataIndex: 'type_name',\n      align: \"center\",\n      width: \"20%\",\n      render: (text, data, index) => /*#__PURE__*/_jsxDEV(\"span\", {\n        children: index !== this.state.tabledtnew.length - 1 ? data.confirm_status == 0 ? /*#__PURE__*/_jsxDEV(Button, {\n          icon: /*#__PURE__*/_jsxDEV(MinusCircleOutlined, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 47\n          }, this),\n          onClick: () => this.dele(data),\n          children: \" \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 33\n        }, this) : \"--\" : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: data.confirm_status == 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              icon: /*#__PURE__*/_jsxDEV(MinusCircleOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 390,\n                columnNumber: 60\n              }, this),\n              onClick: () => this.dele(data),\n              children: \" \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 390,\n              columnNumber: 46\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              icon: /*#__PURE__*/_jsxDEV(PlusCircleOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 391,\n                columnNumber: 60\n              }, this),\n              onClick: this.adddiv,\n              children: \"  \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 46\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 41\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              icon: /*#__PURE__*/_jsxDEV(PlusCircleOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 396,\n                columnNumber: 59\n              }, this),\n              onClick: this.adddiv\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 396,\n              columnNumber: 45\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 394,\n            columnNumber: 41\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 33\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 379,\n        columnNumber: 21\n      }, this)\n    }];\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"StreamingMedia\",\n      children: /*#__PURE__*/_jsxDEV(Table, {\n        columns: columns,\n        rowKey: \"id\",\n        dataSource: this.state.tabledtnew,\n        pagination: {\n          total: this.state.tabledtnew.length,\n          pageSize: this.state.tabledtnew.length\n        },\n        footer: this.footer\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 419,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 12\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Users/xc/Public/capacity_1103/front_new/src/views/pages/StreamingMedia.js"],"names":["React","Table","Button","Form","InputNumber","notification","MinusCircleOutlined","PlusCircleOutlined","axios","APIURL","StreamingMedia","Component","constructor","props","onFinishFailed","errorInfo","console","log","onFinish","values","staticcreate","footer","state","opendiv","tabledtnew","length","user_name","adddiv","bind","dele","confirmdt","componentDidMount","agetRates","ts","event_id","url","that","get","withCredentials","then","response","data","setState","catch","error","v","bodyFormData","FormData","bit_rate","pre_online_num","message","description","duration","placement","onClick","append","parseInt","post","code","success","msg","id","EngName","render","columns","title","dataIndex","align","width","text","index","bandwidth","confirm_status","confirm_user","confirm_datetime","total","pageSize"],"mappings":"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","sourcesContent":["import React from 'react';\n \nimport { Table, Button,   Form,   InputNumber, notification } from 'antd';\nimport { MinusCircleOutlined, PlusCircleOutlined } from '@ant-design/icons';\nimport axios from \"axios\";\n\n\nimport {  APIURL } from '../../common/constdt.js';\n\n\n \nexport default class StreamingMedia extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            \n            opendiv: false,\n            tabledtnew: [],\n            user_name: null,\n        \n        }\n\n        this.adddiv = this.adddiv.bind(this)\n        this.dele = this.dele.bind(this)\n        this.confirmdt = this.confirmdt.bind(this)\n\n    }\n\n\n    componentDidMount() {\n        \n        this.agetRates()\n \n    }\n\n\n\n    async agetRates() {\n\n\n        const ts = this.props.event_id\n        const url = `${APIURL}/media/list?event_id=${ts}`;\n\n        var that = this;\n        await axios.get(url, { withCredentials: true })\n        .then(function (response) {\n          \n          if (response.data.data) {\n\n            that.setState({\n                \n                tabledtnew: response.data.data,\n            })\n        }\n        })\n        .catch(function (error) {\n          console.log(error);\n           \n          \n        })\n  \n\n \n    }\n\n    onFinishFailed = (errorInfo) => {\n        console.log('Failed:', errorInfo);\n    };\n    onFinish = (values) => {\n             \n        console.log('Success:', values);\n        this.staticcreate(values)\n    }\n    async staticcreate(v){\n        let url = `${APIURL}/media/create`;\n\n        var bodyFormData = new FormData();\n\n        if(!v.bit_rate || !v.pre_online_num){\n             \n            notification.error({\n                message: '提示',\n                description: '请输入！！',\n                duration: 60,\n                placement: 'topCenter',\n                onClick: () => {\n                  console.log('Notification Clicked!');\n                },\n            });\n            return false;\n        }\n        bodyFormData.append(\"bit_rate\", v.bit_rate);\n        bodyFormData.append(\"event_id\",  this.props.event_id);\n        bodyFormData.append(\"pre_online_num\", parseInt(v.pre_online_num));\n   \n  \n         var that = this\n        await axios.post(url, bodyFormData, { withCredentials: true })\n           .then(function (response) {\n             \n             if(response.data.code === 0){\n\n                notification.success({\n                    message: '提示',\n                    description: response.data.msg,\n                    placement: 'topCenter',\n                    onClick: () => {\n                      console.log('Notification Clicked!');\n                    },\n                });\n                 that.setState({\n                     opendiv: false,\n                 })\n                 that.agetRates()\n             } else {\n               \n                 notification.error({\n                    message: '提示',\n                    description: response.data.msg,\n                    duration: 60,\n                    placement: 'topCenter',\n                    onClick: () => {\n                      console.log('Notification Clicked!');\n                    },\n                });\n             }\n             \n           })\n           .catch(function (error) {\n             console.log(error);\n            \n           })\n    }\n\n    adddiv(v) {\n \n        this.setState({\n            opendiv: true,\n        })\n        \n    }\n\n    async dele(v){\n\n        var bodyFormData = new FormData();\n        bodyFormData.append(\"media_id\", v.id);\n        \n\n\n        const url = `${APIURL}/media/delete`;\n\n\n        let that = this;\n        await axios.post(url,bodyFormData, { withCredentials: true })\n        .then(function (response) {\n          \n          \n          if (response.data.code === 0) {\n                 \n                that.agetRates();\n             \n                notification.success({\n                    message: '提示',\n                    description: '删除成功！',\n                    placement: 'topCenter',\n                    onClick: () => {\n                      console.log('Notification Clicked!');\n                    },\n                });\n            }\n        })\n        .catch(function (error) {\n          console.log(error);\n           \n\n        })\n       \n\n    }\n\n\n    async confirmdt(v){\n       \n   \n        const url = `${APIURL}/media/verify`;\n\n        var bodyFormData = new FormData();\n        bodyFormData.append(\"media_id\", v.id);\n        bodyFormData.append(\"event_id\", this.props.event_id);\n\n        if(this.props.EngName){\n            bodyFormData.append(\"user_name\", this.props.EngName);\n        }\n\n      \n\n        let that = this;\n        await axios.post(url, bodyFormData, { withCredentials: true })\n       \n        .then(function (response) {\n         \n          \n          if (response.data.code === 0) {\n                 \n                that.agetRates();\n                \n                notification.success({\n                    message: '提示',\n                    description: '确认成功',\n                    placement: 'topCenter',\n                    onClick: () => {\n                      console.log('Notification Clicked!');\n                    },\n                });\n            }  else {\n                \n               \n               notification.error({\n                message: '提示',\n                description: response.data.msg,\n                duration: 60,\n                placement: 'topCenter',\n                onClick: () => {\n                  console.log('Notification Clicked!');\n                },\n            });\n                 \n            }\n\n\n        })\n        .catch(function (error) {\n            console.log(error);\n            \n          \n        })\n    }\n\n\n    footer = () => {\n         \n    \n        return( <div className=\"tbfootertds\">\n            {this.state.opendiv  || this.state.tabledtnew.length === 0 ? (\n                     <Form\n                        onFinish={this.onFinish}\n                        onFinishFailed={this.onFinishFailed}\n                    >\n                        \n                        <table>\n                        <tbody>\n                        <tr>\n                            <td>\n\n                           \n                            \n                                <Form.Item\n                                    label=\"\"\n                                    name=\"bit_rate\"\n\n                                >\n                                    <InputNumber placeholder=\"码率\" />\n                                </Form.Item>\n                            \n                            </td>\n                            <td>\n\n                            \n                            \n                                <Form.Item\n                                    label=\"\"\n                                    name=\"pre_online_num\"\n\n                                >\n                                    <InputNumber placeholder=\"预估同时在线(万)\" />\n                                </Form.Item>\n                             \n                            </td>\n                            <td><span> -- </span></td>\n                            <td><span> -- </span></td>\n                            <td>\n\n                            \n                             \n                                <Form.Item>\n                                    <Button type=\"primary\" htmlType=\"submit\"> 确认添加\n                                         \n                                    </Button>\n                                </Form.Item>\n\n                          \n                            </td>\n                            </tr>\n                            </tbody>\n                        </table>\n                        \n\n                    </Form>\n                    ) : (\n                        \n                         \"\"\n                    )}\n\n            </div>)\n             \n      };\n      \n\n\n\n    render(){\n\n\n       \n\n          \n        const columns = [\n            {\n                title: '码率（Mbps）',\n                dataIndex: 'bit_rate',\n                align: \"center\",\n                width: \"20%\",\n\n            },\n            {\n                title: '预估同时在线(万)',\n                dataIndex: 'pre_online_num',\n                align: \"center\",\n                width: \"20%\",\n            },\n            {\n                title: '所需宽带',\n                dataIndex: 'bandwidth',\n                align: \"center\",\n                width: \"20%\",\n                render: (text, data, index) => (\n                    <span> {data.bandwidth >= 100 ? data.bandwidth * 0.01 + \"T\" :  data.bandwidth * 10 + \"G\" } </span>\n                )\n            },\n            {\n                title: '平台负责人确认',\n                dataIndex: 'confirm_status',\n                align: \"center\",\n                width: \"20%\",\n                render: (text, data, index) => (\n                    <div>\n                        {data.confirm_status === 0 ? (\n                           \n                            <Button   onClick={()=>this.confirmdt(data)} type=\"primary\" size=\"small\">\n                                确认\n                            </Button>\n\n                                \n                        ): (\n\n                            <div className=\"brespans\"> \n                            <span>\n                              {data.confirm_user } \n                            </span> \n                            <span>\n                              {  data.confirm_datetime } \n                             </span>\n                           </div>\n                          \n                        )}\n                    </div>\n                )\n\n\n            },\n            {\n                title: '操作',\n                dataIndex: 'type_name',\n                align: \"center\",\n                width: \"20%\",\n                render: (text, data, index) => (\n                    <span>\n                        { (index !== this.state.tabledtnew.length - 1) ? (\n                            data.confirm_status == 0 ? (\n                                <Button icon={<MinusCircleOutlined />}  onClick={()=>this.dele(data)}> </Button>\n                            ):(\"--\")\n                            \n\n                        ) : (\n                                <div>\n                                    {data.confirm_status == 0 ? (\n                                        <div>\n                                             <Button icon={<MinusCircleOutlined />}  onClick={()=>this.dele(data)}> </Button>\n                                             <Button icon={<PlusCircleOutlined />} onClick={this.adddiv}>  </Button>\n                                        </div>\n                                    ) : (\n                                        <div>\n                                            \n                                            <Button icon={<PlusCircleOutlined />} onClick={this.adddiv}></Button>\n                                        </div>\n                                    )}\n                                   \n                                </div>\n\n                            )\n\n                        }\n\n\n                    </span>\n                ),\n\n            },\n\n        ];\n\n\n\n        return(\n           <div id=\"StreamingMedia\">\n\n                <Table\n\n                columns={columns}\n                rowKey=\"id\"\n                dataSource={this.state.tabledtnew}\n                pagination={{\n                    total: this.state.tabledtnew.length,\n                    pageSize: this.state.tabledtnew.length,\n                }}\n                footer={this.footer}\n                />\n           </div>\n           \n\n\n        )\n    }\n\n}\n"]},"metadata":{},"sourceType":"module"}